var __awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};App.loadBundle("ckrqduix",["require","exports","./chunk-37baa648.js","./chunk-9a5c0d8f.js","./chunk-bf9db9f1.js","./chunk-a5be4357.js","./chunk-5a4be5b7.js","./chunk-c2e7b2b6.js"],function(t,e,n,r,o,i,a,s){var u=window.App.h,c=o.Plugins.Haptics,l=function(){function t(){this.toastCtrl=null,this.musicSrc="",this.musicTitle=null,this.genre="Not available",this.likes="Not available",this.desc="Not available",this.playing=!1,this.token=null,this.onDetail=!1,this.hasSeenTutorial=null,this.audioEl=null,this.saveButtonEl=null}return t.prototype.onSWUpdate=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.toastCtrl?[4,this.toastCtrl.create({message:"New version available",showCloseButton:!0,closeButtonText:"Reload"})]:[3,4];case 1:return[4,(t=e.sent()).present()];case 2:return e.sent(),[4,t.onWillDismiss()];case 3:e.sent(),e.label=4;case 4:return window.location.reload(),[2]}})})},t.prototype.componentWillLoad=function(){this.hasSeenTutorial="true"==localStorage.getItem("seen")},t.prototype.componentDidLoad=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return window.Windows&&window.Windows.UI.ViewManagement.ApplicationView&&((t=window.Windows.UI.ViewManagement.ApplicationView.getForCurrentView().titleBar).backgroundColor={a:255,r:32,g:44,b:56},t.foregroundColor={a:255,r:255,g:255,b:255},t.inactiveBackgroundColor={a:255,r:32,g:44,b:56},t.inactiveForegroundColor={a:255,r:32,g:44,b:56},t.buttonBackgroundColor={a:255,r:32,g:44,b:56}),window.matchMedia("(min-width: 1200px)").matches&&!0===this.hasSeenTutorial&&(this.musicTitle="Nothing Playing"),[2]})})},t.prototype.doWakeLock=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n=this;return __generator(this,function(r){switch(r.label){case 0:if(!("getWakeLock"in navigator))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,navigator.getWakeLock("screen")];case 2:return t.wakeLockObj=r.sent(),this.wakeLockObj.addEventListener("activechange",function(){console.log("The "+n.wakeLockObj.type+" wake lock is "+(n.wakeLockObj.active?"active":"not active")+".")}),[3,4];case 3:return e=r.sent(),console.error("Could not obtain wake lock",e),[3,4];case 4:this.wakeLockRequest=this.wakeLockObj.createRequest(),r.label=5;case 5:return[2]}})})},t.prototype.play=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){switch(n.label){case 0:return c&&c.impact({style:o.HapticsImpactStyle.Light}),this.playing=!0,[4,this.doWakeLock()];case 1:return n.sent(),t&&t.detail&&t.detail.track&&(console.log("playEvent",t.detail.track),this.currentTrack=t.detail.track,this.musicSrc=t.detail.track.stream_url,this.musicTitle=t.detail.track.title,this.genre=t.detail.track.genre,this.likes=t.detail.track.likes_count,this.desc=t.detail.track.description,this.audioEl&&(this.audioEl.oncanplay=function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.prevSong=t.detail.track,console.log("playing"),this.audioEl?[4,this.audioEl.play()]:[3,2];case 1:e.sent(),window.ExperimentalBadge&&window.ExperimentalBadge.set(),this.setUpListeners(),this.setUpMeta(t.detail.track),window.Windows&&(this.systemMediaControls.playbackStatus=window.Windows.Media.MediaPlaybackStatus.playing),e.label=2;case 2:return[2]}})})})),[2]}})})},t.prototype.saveEventHandler=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t&&t.detail&&t.detail.track?(console.log("saving"),[4,this.save(t.detail.track)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.pause=function(){this.playing=!1,c&&c.impact({style:o.HapticsImpactStyle.Light}),this.audioEl&&(this.audioEl.pause(),window.ExperimentalBadge&&window.ExperimentalBadge.clear(),window.Windows&&(this.systemMediaControls.playbackStatus=window.Windows.Media.MediaPlaybackStatus.paused)),this.wakeLockRequest&&(this.wakeLockRequest.cancel(),this.wakeLockRequest=null)},t.prototype.homePlay=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.musicSrc?(c&&c.impact({style:o.HapticsImpactStyle.Light}),this.playing=!0,this.audioEl?[4,this.audioEl.play()]:[3,2]):[3,3];case 1:t.sent(),window.ExperimentalBadge&&window.ExperimentalBadge.set(),window.Windows&&(this.systemMediaControls.playbackStatus=window.Windows.Media.MediaPlaybackStatus.playing),t.label=2;case 2:return[3,5];case 3:return this.playing=!0,[4,this.next()];case 4:t.sent(),t.label=5;case 5:return[2]}})})},t.prototype.next=function(){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(n){switch(n.label){case 0:return c&&c.impact({style:o.HapticsImpactStyle.Light}),console.log(this.genre),[4,i.getSingleTrack(this.genre?this.genre:"")];case 1:return t=n.sent(),this.currentTrack=t,this.musicSrc=t.stream_url,this.musicTitle=t.title,this.genre=t.genre,this.likes=t.likes_count,this.desc=t.description,this.audioEl&&(this.audioEl.oncanplay=function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return this.prevSong=t,this.setUpMeta(t),[2]})})}),[2]}})})},t.prototype.prev=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return console.log("here",this.prevSong),c&&c.impact({style:o.HapticsImpactStyle.Light}),this.prevSong?this.audioEl?[4,this.audioEl.pause()]:[3,2]:[3,3];case 1:t.sent(),this.audioEl.currentTime=0,t.label=2;case 2:return this.setUpMeta(this.prevSong),this.prevSong=null,[3,4];case 3:this.next(),t.label=4;case 4:return[2]}})})},t.prototype.setUpListeners=function(){var t=this;this.audioEl&&this.audioEl.addEventListener("ended",function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return t.sent(),[2]}})})})},t.prototype.systemMediaControlsButtonPressed=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.button!==window.Windows.Media.SystemMediaTransportControlsButton.play?[3,2]:(console.log("playing from windows"),[4,this.homePlay()]);case 1:return e.sent(),[3,8];case 2:return t.button!==window.Windows.Media.SystemMediaTransportControlsButton.pause?[3,4]:[4,this.pause()];case 3:return e.sent(),this.systemMediaControls.playbackStatus=window.Windows.Media.MediaPlaybackStatus.paused,[3,8];case 4:return t.button!==window.Windows.Media.SystemMediaTransportControlsButton.next?[3,6]:[4,this.next()];case 5:return e.sent(),[3,8];case 6:return t.button!==window.Windows.Media.SystemMediaTransportControlsButton.previous?[3,8]:[4,this.prev()];case 7:e.sent(),e.label=8;case 8:return[2]}})})},t.prototype.setUpMeta=function(t){var e=this;if(console.log(t),"mediaSession"in navigator&&(console.log("in media session",t),navigator.mediaSession.metadata=new MediaMetadata({title:t.title?t.title:"",artist:t.user.username?t.user.username:""}),navigator.mediaSession.setActionHandler("play",function(){return e.homePlay()}),navigator.mediaSession.setActionHandler("pause",function(){return e.pause()}),navigator.mediaSession.setActionHandler("previoustrack",function(){return e.homePlay()}),navigator.mediaSession.setActionHandler("nexttrack",function(){return e.next()})),window.Windows){console.log("here"),this.systemMediaControls=window.Windows.Media.SystemMediaTransportControls.getForCurrentView(),this.systemMediaControls.addEventListener("buttonpressed",function(t){return e.systemMediaControlsButtonPressed(t)},!0),this.systemMediaControls.isPlayEnabled=!0,this.systemMediaControls.isPauseEnabled=!0,this.systemMediaControls.isStopEnabled=!0,this.systemMediaControls.isNextEnabled=!0,this.systemMediaControls.isPreviousEnabled=!0;var n=this.systemMediaControls.displayUpdater;n.type=window.Windows.Media.MediaPlaybackType.music,n.musicProperties.artist=t.user.username,n.musicProperties.title=t.title,n.thumbnail=window.Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(new window.Windows.Foundation.Uri(t.artwork_url)),n.update()}},t.prototype.save=function(t){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(r){switch(r.label){case 0:return c&&c.impact({style:o.HapticsImpactStyle.Light}),!this.currentTrack||t?[3,5]:(e=[{transform:"translate3d(-1px, 0, 0)"},{transform:"translate3d(2px, 0, 0)"},{transform:"translate3d(-4px, 0, 0)"},{transform:"translate3d(4px, 0, 0)"}],this.saveButtonEl?(this.saveButtonEl.animate(e,{duration:300}),[4,a.saveSong(this.currentTrack)]):[3,4]);case 1:return r.sent(),this.toastCtrl?[4,this.toastCtrl.create({message:"Song saved",showCloseButton:!0,closeButtonText:"Ok",duration:2e3})]:[3,4];case 2:return[4,r.sent().present()];case 3:r.sent(),r.label=4;case 4:return[3,9];case 5:return[4,a.saveSong(t)];case 6:return n=r.sent(),this.toastCtrl&&!0===n?[4,this.toastCtrl.create({message:"Song saved",showCloseButton:!0,closeButtonText:"Ok",duration:2e3})]:[3,9];case 7:return[4,r.sent().present()];case 8:r.sent(),r.label=9;case 9:return[2]}})})},t.prototype.close=function(){this.musicSrc="",this.musicTitle="",this.playing=!1,this.genre="",this.likes="",this.desc="",window.ExperimentalBadge&&window.ExperimentalBadge.clear(),this.wakeLockRequest&&(this.wakeLockRequest.cancel(),this.wakeLockRequest=null)},t.prototype.render=function(){var t=this;return u("ion-app",null,u("ion-router",{useHash:!0},u("ion-route-redirect",{from:"/",to:this.hasSeenTutorial?"/home":"/intro"}),u("ion-route",{url:"/intro",component:"app-intro"}),u("ion-route",{url:"/home",component:"app-home"}),u("ion-route",{url:"/profile/:name",component:"app-profile"}),u("ion-route",{url:"/track/:id",component:"track-detail"})),u("ion-nav",null),u("audio",{autoplay:!0,ref:function(e){return t.audioEl=e},src:this.musicSrc+"?client_id=a7Ucuq0KY8Ksn8WzBG6wj4x6pcId6BpU"}),this.musicTitle?u("footer",null,u("div",{id:"expandedInfo"},u("h3",null,this.musicTitle||"Nothing Playing"),u("p",null,"Genre: ",this.genre||"Not available"),u("p",null,"Likes: ",this.likes||"Not available"),u("p",null,"Description: ",this.desc||"Not available")),u("div",{id:"mobileInfo"},u("h3",null,this.musicTitle)),u("div",{id:"buttonBlock"},u("ion-button",{fill:"clear",id:"playCloseButton",onClick:function(){return t.close()}},u("ion-icon",{name:"close"})),u("ion-button",{fill:"clear","aria-label":"Previous button",onClick:function(){return t.prev()}},u("ion-icon",{name:"skip-backward"})),this.playing?u("ion-button",{key:"end",fill:"clear",class:"slightlyBigger","aria-label":"Pause button",onClick:function(){return t.pause()}},u("ion-icon",{name:"pause",size:"large"})):u("ion-button",{key:"start",fill:"clear",class:"slightlyBigger","aria-label":"Play button",onClick:function(){return t.homePlay()}},u("ion-icon",{name:"play",size:"large"})),u("ion-button",{fill:"clear","aria-label":"Next button",onClick:function(){return t.next()}},u("ion-icon",{name:"skip-forward"})),u("ion-button",{fill:"clear",ref:function(e){return t.saveButtonEl=e},"aria-label":"Sharing button",id:"desktopShareButton",onClick:function(){return t.save()}},u("ion-icon",{name:"star-outline"})))):null)},Object.defineProperty(t,"is",{get:function(){return"app-root"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{currentTrack:{state:!0},desc:{state:!0},genre:{state:!0},hasSeenTutorial:{state:!0},likes:{state:!0},musicSrc:{state:!0},musicTitle:{state:!0},onDetail:{state:!0},playing:{state:!0},toastCtrl:{connect:"ion-toast-controller"},token:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"listeners",{get:function(){return[{name:"window:swUpdate",method:"onSWUpdate"},{name:"playEvent",method:"play"},{name:"saveEvent",method:"saveEventHandler"}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"footer{position:fixed;bottom:-2px;width:100%;display:-ms-flexbox;display:flex;background:var(--ion-color-primary);height:8em;-ms-flex-pack:space-evenly;justify-content:space-evenly;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column;-webkit-animation-name:slideup;animation-name:slideup;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-timing-function:cubic-bezier(.55,0,.1,1);animation-timing-function:cubic-bezier(.55,0,.1,1)}#playCloseButton{color:#fff;font-size:1em;position:absolute;top:4px;left:0}#buttonBlock ion-button ion-icon{color:#fff}footer #buttonBlock{width:60%;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-direction:row;flex-direction:row;display:-ms-flexbox;display:flex}#infoBlock{width:50%;padding:12px}#infoBlock p{color:#fff;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}footer button{background:transparent;border:none;outline-color:#215f77}#expandedInfo{display:none}#expandedInfo p{text-overflow:ellipsis;overflow:hidden}#expandedInfo h3{font-weight:700}#mobileInfo{color:#fff;font-size:1.2em;height:33px;-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex}#mobileInfo,#mobileInfo h3{width:100%;text-align:center}#mobileInfo h3{margin-bottom:0;margin-top:0;overflow:hidden;text-overflow:ellipsis;-webkit-animation-name:fadein;animation-name:fadein;-webkit-animation-duration:.3s;animation-duration:.3s;font-size:18px;font-weight:400;padding-left:75px;padding-right:75px}#desktopShareButton{color:#fff;position:absolute;top:2px;right:0}\@media (min-width:1200px){#desktopShareButton{top:4px}}#playCloseButton ion-icon{margin-top:2px}#headerBlock{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}\@-webkit-keyframes fadein{0%{opacity:0}to{opacity:1}}\@keyframes fadein{0%{opacity:0}to{opacity:1}}\@-webkit-keyframes slideup{0%{opacity:0;-webkit-transform:translateY(300px);transform:translateY(300px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}\@keyframes slideup{0%{opacity:0;-webkit-transform:translateY(300px);transform:translateY(300px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}\@media(min-width:1200px){footer{position:fixed;bottom:auto;top:3.5em;width:230px;height:100%;display:block;text-align:center}#infoBlock{width:auto;text-align:center}#expandedInfo{display:block;padding:20px;color:#fff;text-align:left;margin-top:1.6em}#mobileInfo{display:none}footer #buttonBlock{padding-left:20px;padding-right:15px;width:90%}}"},enumerable:!0,configurable:!0}),t}(),h=function(){function e(){}return e.prototype.componentDidLoad=function(){var e=this;r.rIC(function(){var n=e.win,r=e.config,o=e.queue;r.getBoolean("_testing")||function(e,n){new Promise(function(e,n){t(["./chunk-e89efc0a.js"],e,n)}).then(function(t){return t.startTapClick(e.document,n)})}(n,r),function(e,n){n.getBoolean("inputShims",function(t){return s.isPlatform(t,"ios")&&s.isPlatform(t,"mobile")}(e))&&new Promise(function(e,n){t(["./chunk-1ce9020c.js"],e,n)}).then(function(t){return t.startInputShims(e.document,n)})}(n,r),function(e,n,r){n.getBoolean("statusTap",s.isPlatform(e,"hybrid"))&&new Promise(function(e,n){t(["./chunk-dc9f5104.js"],e,n)}).then(function(t){return t.startStatusTap(e,r)})}(n,r,o),function(e,n){n.getBoolean("hardwareBackButton",s.isPlatform(e,"hybrid"))&&new Promise(function(e,n){t(["./chunk-a1b3902f.js"],e,n)}).then(function(t){return t.startHardwareBackButton(e)})}(n,r),function(e){new Promise(function(e,n){t(["./chunk-03236d39.js"],e,n)}).then(function(t){return t.startFocusVisible(e.document)})}(n)})},e.prototype.hostData=function(){return{class:{"ion-page":!0,"force-statusbar-padding":this.config.getBoolean("_forceStatusbarPadding")}}},Object.defineProperty(e,"is",{get:function(){return"ion-app"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{config:{context:"config"},el:{elementRef:!0},queue:{context:"queue"},win:{context:"window"}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}"},enumerable:!0,configurable:!0}),e}(),d=function(){function t(){this.url=""}return t.prototype.onUpdate=function(t){this.ionRouteDataChanged.emit(t)},t.prototype.onComponentProps=function(t,e){if(t!==e){var n=t?Object.keys(t):[],r=e?Object.keys(e):[];if(n.length===r.length)for(var o=0,i=n;o<i.length;o++){var a=i[o];if(t[a]!==e[a])return void this.onUpdate(t)}else this.onUpdate(t)}},t.prototype.componentDidLoad=function(){this.ionRouteDataChanged.emit()},t.prototype.componentDidUnload=function(){this.ionRouteDataChanged.emit()},Object.defineProperty(t,"is",{get:function(){return"ion-route"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{component:{type:String,attr:"component",watchCallbacks:["onUpdate"]},componentProps:{type:"Any",attr:"component-props",watchCallbacks:["onComponentProps"]},url:{type:String,attr:"url",watchCallbacks:["onUpdate"]}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"events",{get:function(){return[{name:"ionRouteDataChanged",method:"ionRouteDataChanged",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),t}(),p=function(){function t(){}return t.prototype.propDidChange=function(){this.ionRouteRedirectChanged.emit()},t.prototype.componentDidLoad=function(){this.ionRouteRedirectChanged.emit()},t.prototype.componentDidUnload=function(){this.ionRouteRedirectChanged.emit()},Object.defineProperty(t,"is",{get:function(){return"ion-route-redirect"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{from:{type:String,attr:"from",watchCallbacks:["propDidChange"]},to:{type:String,attr:"to",watchCallbacks:["propDidChange"]}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"events",{get:function(){return[{name:"ionRouteRedirectChanged",method:"ionRouteRedirectChanged",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),t}(),f="root";function g(t){return"/"+t.filter(function(t){return t.length>0}).join("/")}function m(t){if(null==t)return[""];var e=t.split("/").map(function(t){return t.trim()}).filter(function(t){return t.length>0});return 0===e.length?[""]:e}function w(t,e,n,r,o){return void 0===o&&(o=!1),__awaiter(this,void 0,void 0,function(){var i,a,s,u;return __generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),i=y(t),r>=e.length||!i?[2,o]:[4,i.componentOnReady()];case 1:return c.sent(),[4,i.setRouteId((a=e[r]).id,a.params,n)];case 2:return(s=c.sent()).changed&&(n=f,o=!0),[4,w(s.element,e,n,r+1,o)];case 3:return o=c.sent(),s.markVisible?[4,s.markVisible()]:[3,5];case 4:c.sent(),c.label=5;case 5:return[2,o];case 6:return u=c.sent(),console.error(u),[2,!1];case 7:return[2]}})})}function b(t){return __awaiter(this,void 0,void 0,function(){var e,n,r,o;return __generator(this,function(i){switch(i.label){case 0:e=[],r=t,i.label=1;case 1:return(n=y(r))?[4,n.getRouteId()]:[3,3];case 2:return(o=i.sent())?(r=o.element,o.element=void 0,e.push(o),[3,4]):[3,5];case 3:return[3,5];case 4:return[3,1];case 5:return[2,{ids:e,outlet:n}]}})})}var v=":not([no-router]) ion-nav, :not([no-router]) ion-tabs, :not([no-router]) ion-router-outlet";function y(t){if(t)return t.matches(v)?t:t.querySelector(v)||void 0}function k(t,e){return e.find(function(e){return function(t,e){var n=e.from;if(void 0===e.to)return!1;if(n.length>t.length)return!1;for(var r=0;r<n.length;r++){var o=n[r];if("*"===o)return!0;if(o!==t[r])return!1}return n.length===t.length}(t,e)})}function _(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n&&t[r].toLowerCase()===e[r].id;r++);return r}function C(t,e){for(var n,r=new R(t),o=!1,i=0;i<e.length;i++){var a=e[i].path;if(""===a[0])o=!0;else{for(var s=0,u=a;s<u.length;s++){var c=u[s],l=r.next();if(":"===c[0]){if(""===l)return null;((n=n||[])[i]||(n[i]={}))[c.slice(1)]=l}else if(l!==c)return null}o=!1}}return o&&o!==(""===r.next())?null:n?e.map(function(t,e){return{id:t.id,path:t.path,params:S(t.params,n[e])}}):e}function S(t,e){return!t&&e?e:t&&!e?t:t&&e?Object.assign({},t,e):void 0}function P(t){for(var e=1,n=1,r=0,o=t;r<o.length;r++)for(var i=0,a=o[r].path;i<a.length;i++){var s=a[i];":"===s[0]?e+=Math.pow(1,n):""!==s&&(e+=Math.pow(2,n)),n++}return e}var R=function(){function t(t){this.path=t.slice()}return t.prototype.next=function(){return this.path.length>0?this.path.shift():""},t}();function E(t){return Array.from(t.children).filter(function(t){return"ION-ROUTE-REDIRECT"===t.tagName}).map(function(t){var e=M(t,"to");return{from:m(M(t,"from")),to:null==e?void 0:m(e)}})}function B(t){return function(t){for(var e=[],n=0,r=t;n<r.length;n++){x([],e,r[n])}return e}(function t(e,n){return void 0===n&&(n=e),Array.from(n.children).filter(function(t){return"ION-ROUTE"===t.tagName&&t.component}).map(function(n){var r=M(n,"component");if(null==r)throw new Error("component missing in ion-route");return{path:m(M(n,"url")),id:r.toLowerCase(),params:n.componentProps,children:t(e,n)}})}(t))}function M(t,e){return e in t?t[e]:t.hasAttribute(e)?t.getAttribute(e):null}function x(t,e,n){var r=t.slice();if(r.push({id:n.id,path:n.path,params:n.params}),0!==n.children.length)for(var o=0,i=n.children;o<i.length;o++)x(r,e,i[o]);else e.push(r)}var L=function(){function t(){this.previousPath=null,this.busy=!1,this.state=0,this.lastState=0,this.root="/",this.useHash=!0}return t.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,(e=this.win,y(e.document.body)?Promise.resolve():new Promise(function(t){e.addEventListener("ionNavWillLoad",t,{once:!0})}))];case 1:return t.sent(),[4,this.onRoutesChanged()];case 2:return t.sent(),[2]}var e})})},t.prototype.componentDidLoad=function(){this.win.addEventListener("ionRouteRedirectChanged",r.debounce(this.onRedirectChanged.bind(this),10)),this.win.addEventListener("ionRouteDataChanged",r.debounce(this.onRoutesChanged.bind(this),100))},t.prototype.onPopState=function(){var t=this.historyDirection(),e=this.getPath();return this.writeNavStateRoot(e,t)},t.prototype.onBackButton=function(t){var e=this;t.detail.register(0,function(){return e.back()})},t.prototype.push=function(t,e){void 0===e&&(e="forward"),t.startsWith(".")&&(t=new URL(t,window.location.href).pathname);var n=m(t);return this.setPath(n,e),this.writeNavStateRoot(n,e)},t.prototype.back=function(){return this.win.history.back(),Promise.resolve(this.waitPromise)},t.prototype.printDebug=function(){this.getPath(),function(t){console.group("[ion-core] ROUTES["+t.length+"]");for(var e=function(t){var e=[];t.forEach(function(t){return e.push.apply(e,t.path)});var n=t.map(function(t){return t.id});g(e),n.join(", ")},n=0,r=t;n<r.length;n++)e(r[n]);console.groupEnd()}(B(this.el)),function(t){console.group("[ion-core] REDIRECTS["+t.length+"]");for(var e=0,n=t;e<n.length;e++){var r=n[e];r.to&&(g(r.from),g(r.to))}console.groupEnd()}(E(this.el))},t.prototype.navChanged=function(t){return __awaiter(this,void 0,void 0,function(){var e,n,r,o,i,a;return __generator(this,function(s){switch(s.label){case 0:return this.busy?(console.warn("[ion-router] router is busy, navChanged was cancelled"),[2,!1]):[4,b(this.win.document.body)];case 1:return e=s.sent(),n=e.ids,r=e.outlet,o=B(this.el),(i=function(t,e){for(var n=null,r=0,o=t.map(function(t){return t.id}),i=0,a=e;i<a.length;i++){var s=a[i],u=_(o,s);u>r&&(n=s,r=u)}return n?n.map(function(e,n){return{id:e.id,path:e.path,params:S(e.params,t[n]&&t[n].params)}}):null}(n,o))?(a=function(t){for(var e=[],n=0,r=t;n<r.length;n++)for(var o=r[n],i=0,a=o.path;i<a.length;i++){var s=a[i];if(":"===s[0]){var u=o.params&&o.params[s.slice(1)];if(!u)return null;e.push(u)}else""!==s&&e.push(s)}return e}(i))?(this.setPath(a,t),[4,this.safeWriteNavState(r,i,f,a,null,n.length)]):(console.warn("[ion-router] router could not match path because some required param is missing"),[2,!1]):(console.warn("[ion-router] no matching URL for ",n.map(function(t){return t.id})),[2,!1]);case 2:return s.sent(),[2,!0]}})})},t.prototype.onRedirectChanged=function(){var t=this.getPath();t&&k(t,E(this.el))&&this.writeNavStateRoot(t,f)},t.prototype.onRoutesChanged=function(){return this.writeNavStateRoot(this.getPath(),f)},t.prototype.historyDirection=function(){var t=this.win;null===t.history.state&&(this.state++,t.history.replaceState(this.state,t.document.title,t.document.location&&t.document.location.href));var e=t.history.state,n=this.lastState;return this.lastState=e,e>n?"forward":e<n?"back":f},t.prototype.writeNavStateRoot=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,r,o,i,a;return __generator(this,function(s){return t?(n=E(this.el),r=k(t,n),o=null,r&&(this.setPath(r.to,e),o=r.from,t=r.to),i=B(this.el),(a=function(t,e){for(var n=null,r=0,o=0,a=i;o<a.length;o++){var s=C(t,a[o]);if(null!==s){var u=P(s);u>r&&(r=u,n=s)}}return n}(t))?[2,this.safeWriteNavState(this.win.document.body,a,e,t,o)]:(console.error("[ion-router] the path does not match any route"),[2,!1])):(console.error("[ion-router] URL is not part of the routing set"),[2,!1])})})},t.prototype.safeWriteNavState=function(t,e,n,r,o,i){return void 0===i&&(i=0),__awaiter(this,void 0,void 0,function(){var a,s,u;return __generator(this,function(c){switch(c.label){case 0:return[4,this.lock()];case 1:a=c.sent(),s=!1,c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.writeNavState(t,e,n,r,o,i)];case 3:return s=c.sent(),[3,5];case 4:return u=c.sent(),console.error(u),[3,5];case 5:return a(),[2,s]}})})},t.prototype.lock=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return t=this.waitPromise,this.waitPromise=new Promise(function(t){return e=t}),void 0===t?[3,2]:[4,t];case 1:n.sent(),n.label=2;case 2:return[2,e]}})})},t.prototype.writeNavState=function(t,e,n,r,o,i){return void 0===i&&(i=0),__awaiter(this,void 0,void 0,function(){var a,s;return __generator(this,function(u){switch(u.label){case 0:return this.busy?(console.warn("[ion-router] router is busy, transition was cancelled"),[2,!1]):(this.busy=!0,(a=this.routeChangeEvent(r,o))&&this.ionRouteWillChange.emit(a),[4,w(t,e,n,i)]);case 1:return s=u.sent(),this.busy=!1,a&&this.ionRouteDidChange.emit(a),[2,s]}})})},t.prototype.setPath=function(t,e){this.state++,function(t,e,n,r,o,i){var a=g(m(e).concat(r));n&&(a="#"+a),"forward"===o?t.pushState(i,"",a):t.replaceState(i,"",a)}(this.win.history,this.root,this.useHash,t,e,this.state)},t.prototype.getPath=function(){return function(t,e,n){var r=t.pathname;if(n){var o=t.hash;r="#"===o[0]?o.slice(1):""}return function(t,e){if(t.length>e.length)return null;if(t.length<=1&&""===t[0])return e;for(var n=0;n<t.length;n++)if(t[n].length>0&&t[n]!==e[n])return null;return e.length===t.length?[""]:e.slice(t.length)}(m(e),m(r))}(this.win.location,this.root,this.useHash)},t.prototype.routeChangeEvent=function(t,e){var n=this.previousPath,r=g(t);return this.previousPath=r,r===n?null:{from:n,redirectedFrom:e?g(e):null,to:r}},Object.defineProperty(t,"is",{get:function(){return"ion-router"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{back:{method:!0},config:{context:"config"},el:{elementRef:!0},navChanged:{method:!0},printDebug:{method:!0},push:{method:!0},queue:{context:"queue"},root:{type:String,attr:"root"},useHash:{type:Boolean,attr:"use-hash"},win:{context:"window"}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"events",{get:function(){return[{name:"ionRouteWillChange",method:"ionRouteWillChange",bubbles:!0,cancelable:!0,composed:!0},{name:"ionRouteDidChange",method:"ionRouteDidChange",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"listeners",{get:function(){return[{name:"window:popstate",method:"onPopState"},{name:"document:ionBackButton",method:"onBackButton"}]},enumerable:!0,configurable:!0}),t}();e.AppRoot=l,e.IonApp=h,e.IonRoute=d,e.IonRouteRedirect=p,e.IonRouter=L,Object.defineProperty(e,"__esModule",{value:!0})});